# snsrCollector
Проект Сенсорика. Сервис по сбору данных с приборов мониторинга окружающей среды.

# Описание
## Введение
Областью применения комплекса ¬– системы экологического и метеорологического мониторинга.
«Разработка облачного хранилища и программно-алгоритмического обеспечения для структурирования и унификации данных »
# Основания для разработки
НТИ по направлению сквозной технологии «Технологии сенсорики».
# Назначение разработки
Целью настоящего проекта является разработка и реализация программно-алгоритмического обеспечения для структурирования и унификации данных в системах экологического и метеорологического мониторинга. Основная решаемая задача состоит в  автоматизации сбора и сохранения данных, получаемых от автономных метеорологических комплексов в рамках подсистемы позволяющей осуществлять первичное формирование информационных потоков, сохраняемых в базах данных по шаблону; формирование баз данных в облачных хранилищах либо на закрытых серверах организаций. Отдельно решается задача разработки сервисов по обработке данных и системы визуализации измеряемых параметров для удобного экологического и метеорологического мониторинга окружающей среды.

# Развёртывание проекта на Ubuntu 19.04 x64.

## Требования к окружению.
**Установлены:**  
1. Пакет dotnet-sdk-3.1
2. Пакет apt-transport-https
3. postgre sql server 12 версии.
4. PgAdmin 4 для администрирования БД.

## Сборка проекта.
Для сборки проекта используется Visual Studio 2019. Чтобы собрать проект, необходимо через *контекстное меню решения (пкм) -> Publish*  
![Alt text](/Pulish_button.jpg?raw=true "Переход к публикации приложения.")  
Необходимо перейти в меню редактирования настроек сборки через кнопку *edit*. В открывшемся меня для сборки на Ubuntu должны быть указаны следующие настройки (вместо Release path укзать путь, куда выкладывать сборку):  
![Alt text](/Profile_Settings.jpg?raw=true "Настройки публикации приложения.")  
Перед запуском проекта на ubuntu необходимо настроить appConfig.ini. 

### Описание ключей файла конфигурации
**logLevel** - уровень логирования. Доступны INFO, WARN, DEBUG.  
**DbHost** - месторасположение хоста БД.  
**DbName** - название БД, с которой связывается snsrCollector.  
**DbUser** - пользователь, от имени которого snsrCollector взаимодействует с БД.  
**DbPassword** - пароль пользователя.  

## Запуск проекта.
Запуск проекта происходит через terminal в ubuntu с помощью команды ./snsrCollector.

# Эмулятор для отладки приложения.
Для тестирования используется проект ps2 (https://github.com/mivafoxy/ps2), который имитирует работу шлюза, отсылающего значения с датчиков. Сборка проекта соответствует инструкции к snsrCollector. Для запуска эмулятора на ubuntu необходимо указать аргумент host - адрес подключения к серверу, port - порт подключения к серверу, milliseconds - интервал между итерациями отправки сообщения.

## Описание архитектуры.

# Главный замысел.
Сервер имеет движок, который управляет запуском опроса по каналам и завершением этого опроса. Приложение тесно связано с базой данных, из которой оно берёт информацию для опроса приборов. Единицей работы является модуль опроса. Множество этих "единиц" объединяется в "канал" - сущность, по которой данные принимаются и передаются от датчиков в модуль. 
В движке производится вызов загрузки из базы данных информации для создания каналов, в которых содержатся модули опроса. 
![Alt text](/SnsrCollector.jpg?raw=true "Концепция приложения.") 

# Архитектура БД.
В архитектуру БД заложена возможность одновременной работы с SnsrCollector и приложениями для отображения данных, полученных от датчиков при помощи SnsrCollector. 
В БД содержатся таблицы, которые описывают "чертёж" устройства. Это позволит сторонним приложениям создавать устройства по шаблону, уменьшая затрачиваемое время по заведению информации об устройствах.  
Таблица Network необходима, чтобы строить иерархию устройств. Таким образом, "бегая" по дереву из устройств, можно знать их свойства и использовать это для логики опроса/отображения данных.